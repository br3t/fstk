<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="utf-8" />
	<title>Основы JavaScript 4.1. Встроенные инструменты@ Курс Frontend-разработки</title>
	<link rel="stylesheet" type="text/css" href="../../css/style.css" />
	<style>
		.methods {
			border: 1px solid #000;
			border-collapse: collapse;
			width: 100%;
		}
		.methods tr:nth-child(2n) {
			background: #FFF;
		}
		.methods td,
		.methods th {
			border: 1px solid #000;
			padding: 5px 7px;
			text-align: left;
			vertical-align: top;
		}
		.methods th {
			width: 400px;
			font-family: Menlo, "Lucida Sans Typewriter", monospace;;
		}
	</style>
</head>
<body>
	<h1>Основы JavaScript 4.1. Встроенные инструменты</h1>
	<h2>Работа со строками</h2>
	<p>Длина строки доступна с помощью свойства <b>length</b>. Несмотря на то, что отдельный символ строки можно получить с помощью квадратных скобок, что делает строки похожими на массив символов, изменением <b>length</b> нельзя обрезать строку.</p>
	<code class="listing">
		<span class="key">var</span> language = <span class="string">'javascript'</span>;<br />
		alert(language.length); <span class="comment">// 10</span><br />
		language.length = 3;<br />
		alert(language.length); <span class="comment">// 10, нельзя изменить длину</span><br />
		alert(language[0]); <span class="comment">// "j", отсчет символов начинается с нуля</span><br />
	</code>
	<p>Для работы со строками в JavaScript существуют следующие методы:</p>
	<table class="methods">
		<tr>
			<th>charAt(<em>n</em>)</th>
			<td>возвращает символ с индексом <b>n</b>. Аналог <b>[n]</b></td>
		</tr>
		<tr>
			<th>charCodeAt(<em>n</em>)</th>
			<td>возвращает Unicode-код символа в позиции <b>n</b></td>
		</tr>
		<tr>
			<th>String.fromCharCode(<em>code</em>)</th>
			<td>возвращает символ по его Unicode-коду <b>code</b></td>
		</tr>
		<tr>
			<th>indexOf(<em>subString [, start]</em>)</th>
			<td>возвращает позицию найденной подстроки или -1, если подстрока не найдена. В <b>start</b> можно указать, с какой позиции начинать поиск</td>
		</tr>
		<tr>
			<th>toUpperCase()</th>
			<td>перевод строки в верхний регистр</td>
		</tr>
		<tr>
			<th>toLowerCase()</th>
			<td>перевод строки в нижний регистр</td>
		</tr>
		<tr>
			<th>substr(<em>start [, size]</em>)</th>
			<td>возвращает подстроку, начинающуюся со <b>start</b>, и размером <b>size</b> или до конца строки</td>
		</tr>
		<tr>
			<th>substring(<em>start [, finish]</em>)</th>
			<td>возвращает подстроку, начинающуюся со <b>start</b>, и до <b>finish</b>, не включая её, или до конца строки. Индексы, выходящие за диапазон строки урезает, при <b>finish < start</b> меняет аргументы местами</td>
		</tr>
		<tr>
			<th>slice(<em>start [, finish]</em>)</th>
			<td>работает аналогично <b>substring</b>, но отрицательные индексы отсчитываются с конца строки</td>
		</tr>
	</table>

	<h2>Работа с числами</h2>
	<p>Способы записи чисел:</p>
	<ul>
		<li>обычная запись <b>n = 10;</b></li>
		<li>"научная запись" <b>n = 1e1;</b></li>
		<li>в восьмиричной системе <b>n = 012;</b></li>
		<li>в шестнадцатиричной системе <b>n = 0xA;</b></li>
	</ul>
	<p>Особенностью чисел в Javascript является неточность вычислений (например, <b>0.1 + 0.2 != 0.3</b>), связанная с тем, что некоторые дробные числа не могут быть представлены в двоичной системе в виде конечной дроби. Следует помнить об этом и по возможности избегать требующих точности вычислений с дробными числами, заменяя их на операции с целыми.</p>
	<p>Для работы с числами в JavaScript существуют следующие функции и методы:</p>
	<table class="methods">
		<tr>
			<th>isNaN(<em>n</em>)</th>
			<td>проверяет <b>n</b> на <b>NaN</b></td>
		</tr>
		<tr>
			<th>isFinite(<em>n</em>)</th>
			<td>проверяет, конечно ли <b>n</b>. Возвращает <b>false</b> для <b>Infinity</b>, <b>-Infinity</b> и <b>NaN</b></td>
		</tr>
		<tr>
			<th>parseInt(<em>n [, base]</em>)</th>
			<td>посимвольно преобразует <b>n</b> в целое число. Если указан <b>base</b>, то интерпретирует <b>n</b> как число в base-ричной системе исчисления. <b>base</b> должно быть больше в пределах 2..36, иначе вернётся <b>NaN</b></td>
		</tr>
		<tr>
			<th>parseFloat(<em>n</em>)</th>
			<td>посимвольно преобразует <b>n</b> в число с дробной частью</td>
		</tr>
		<tr>
			<th>.toString(<em>base</em>)</th>
			<td>преобразует число в строку-число в base-ричной системе исчисления. <b>base</b> должно быть больше в пределах 2..36, иначе сгенерируется ошибка </td>
		</tr>
		<tr>
			<th>.toFixed(<em>precision</em>)</th>
			<td>возвращает строку-число, округленное до <b>precision</b> знаков после запятой. Если значимых значений нет, то дополняет нулями</td>
		</tr>
	</table>
	<h3>Математические функции</h3>
	<p>Для выполнения математических операций используются методы специального объекта <b>Math</b>:</p>
	<table class="methods">
		<tr>
			<th>floor(<em>n</em>)</th>
			<td>округляет <b>n</b> до целого вниз</td>
		</tr>
		<tr>
			<th>ceil(<em>n</em>)</th>
			<td>округляет <b>n</b> до целого вверх</td>
		</tr>
		<tr>
			<th>round(<em>n</em>)</th>
			<td>округляет <b>n</b> до целого по правилам округления</td>
		</tr>
		<tr>
			<th>abs(<em>n</em>)</th>
			<td>вычисляет абсолютное значение для <b>n</b></td>
		</tr>
		<tr>
			<th>sin(<em>angle</em>)</th>
			<td>вычисляет синус угла <b>angle</b>, заданного в радианах</td>
		</tr>
		<tr>
			<th>cos(<em>angle</em>)</th>
			<td>вычисляет косинус угла <b>angle</b>, заданного в радианах</td>
		</tr>
		<tr>
			<th>tan(<em>angle</em>)</th>
			<td>вычисляет тангенс угла <b>angle</b>, заданного в радианах</td>
		</tr>
		<tr>
			<th>asin(<em>n</em></th>
			<td>вычисляет арксинус <b>n</b></td>
		</tr>
		<tr>
			<th>acos(<em>n</em></th>
			<td>вычисляет арккосинус <b>n</b>, результат в раианах</td>
		</tr>
		<tr>
			<th>atan(<em>n</em>)</th>
			<td>вычисляет арктангенс <b>n</b></td>
		</tr>
		<tr>
			<th>atan2(<em>x, y</em>)</th>
			<td>вычисляет угол до точки (x, y)</td>
		</tr>
		<tr>
			<th>min(<em>e1, e2, ...</em>)</th>
			<td>возвращает минимальное значение из аргументов</td>
		</tr>
		<tr>
			<th>max(<em>e1, e2, ...</em>)</th>
			<td>возвращает максимальное значение из аргументов</td>
		</tr>
		<tr>
			<th>pow(<em>n, exp</em>)</th>
			<td>вычисляет <b>n</b> в степени <b>exp</b></td>
		</tr>
		<tr>
			<th>sqrt(<em>n</em>)</th>
			<td>вычисляет квадратный корень из <b>n</b></td>
		</tr>
		<tr>
			<th>log(<em>n</em>)</th>
			<td>вычисляет натуральный логарифм от <b>n</b></td>
		</tr>
		<tr>
			<th>exp(<em>n</em>)</th>
			<td>вычисляет <b>e</b> (экспонента) в степени <b>n</b></td>
		</tr>
		<tr>
			<th>random()</th>
			<td>возвращает псевдослучайное число в диапазоне <b>[0;1)</b></td>
		</tr>
	</table>
	<p>Объект <b>Math</b> также содержит в себе математические константы:</p>
	<ul>
		<li>число Пи: <b>Math.PI = 3.141592653589793</b></li>
		<li>экспоненту: <b>Math.E = 2.718281828459045</b></li>
	</ul>
	<p>и некоторые заранее вычисленные величины:</p>
	<ul>
		<li>квадратный корень из 2: <b>Math.SQRT2 == Math.sqrt(2)</b></li>
		<li>квадратный корень из &frac12;: <b>Math.SQRT1_2 == Math.sqrt(.5)</b></li>
	</ul>

	<h2>Работа с датой и временем</h2>
	<p>Работы с датой и временем в JavaScript осуществляется при помощи объекта <b>Date</b>:</p>
	<code class="listing">
		<span class="comment">// получаем объект текущего момента времени</span><br />
		<span class="key">var</span> dateNow = <span class="key">new</span> Date();<br />
		alert(dateNow); <span class="comment">// <script>document.write(new Date());</script></span><br /><br />
		
		<span class="comment">// получаем текущий timestamp в миллисекундах</span><br />
		<span class="key">var</span> dateNow2 = Date.now();<br />
		alert(dateNow2); <span class="comment">// <script>document.write(Date.now());</script></span><br /><br />

		<span class="comment">// задаем дату в виде миллисекунд, прошедших после после 1 января 1970 года</span><br />
		<span class="key">var</span> dateMilliseconds = <span class="key">new</span> Date(60 * 1000);<br />
		alert(dateMilliseconds); <span class="comment">// Thu Jan 01 1970 02:01:00 GMT+0200 (MSK)</span><br /><br />

		<span class="comment">// задаем дату в виде строки в формате RFC2822</span><br />
		<span class="key">var</span> dateString = <span class="key">new</span> Date(<span class="string">"Wed Oct 11 2017 12:00:00 GMT+0300 (EEST)"</span>);<br />
		alert(dateString); <span class="comment">// Wed Oct 11 2017 12:00:00 GMT+0300 (EEST)</span><br /><br />

		<span class="comment">// задаем дату в виде строки в формате ISO 8601 Extended</span><br />
		<span class="key">var</span> dateString2 = <span class="key">new</span> Date(<span class="string">"2017-10-12T19:30:00+03:00"</span>); <br />
		alert(dateString2); <span class="comment">// Thu Oct 12 2017 19:30:00 GMT+0300 (EEST)</span><br /><br />

		<span class="comment">// задаем дату в виде массива в формате <b>год, месяц, число, часы, минуты, секунды</b></span><br />
		<span class="key">var</span> dateArguments = <span class="key">new</span> Date(2018, 0, 1, 12, 0, 0);<br />
		alert(dateArguments); <span class="comment">// Mon Jan 01 2018 12:00:00 GMT+0200 (MSK)</span><br />
	</code>

	<h2>Работа с JSON</h2>
	<p>JSON &mdash; универсальный формат хранения данных. Для работы с этим форматом в JavaScript используют объект <b>JSON</b> с двумя методами: для извлечения данных из JSON и для преобразования данных в JSON.</p>
	<code class="listing">
		<span class="comment">// извлечение данных</span><br />
		<span class="key">var</span> fromJsonString = <span class="string">'[1, "a", {"b": 2}]'</span>;<br />
		<span class="key">var</span> fromJsonObject = JSON.parse(fromJsonString); <span class="comment">// в переменную попадает распаршенный массив <b>[1, "a", {"b": 2}]</b></span>
	</code>
	<p>С помощью второго наобязательного параметра-функции можно при парсинге обрабатывать свойства результирующего объекта:</p>
	<code class="listing">
		<span class="key">var</span> fromJsonString2 = <span class="string">'{"integer": 1.1, "float": 2.2, "more": {"integer": 3.3}}'</span>;<br />
		<span class="key">var</span> fromJsonObject2 = JSON.parse(fromJsonString2, <span class="var">function</span> (key, value) {<br />
		&nbsp; &nbsp; <span class="var">if</span>(key==<span class="string">"integer"</span>) {<br />
		&nbsp; &nbsp; &nbsp; &nbsp; return parseInt(value);<br />
		&nbsp; &nbsp; }<br />
		&nbsp; &nbsp; return value;<br />
		});<br />
		<span class="comment">// fromJsonObject2={integer: 1, float: 2.2, more: {integer: 3}}</span>
	</code>
	<p>Данная функция работает рекурсивно, т.е. преобразуются все совпадения свойств, в т.ч. и вложенных.</p>
	<p>Для отправки на сервер, сохранения в localStorage и т.д. используют преобразование данных в JSON-строку с помощью метода <b>stringify</b>. Такой процесс называется <b>сериализацией</b></p>
	<code class="listing">
		<span class="key">var</span> toJsonObject = {<span class="string">"name"</span>: <span class="string">"Bill"</span>, <span class="string">"age"</span>: 42};<br />
		<span class="key">var</span> toJsonString = JSON.stringify(toJsonObject);<br />
		<span class="comment">// toJsonString = '{"name":"Bill","age":42}'</span>
	</code>
	<p>С помощью второго необязательного параметра можно указать (с помощью массива или функции), какие свойства необходимо сериализовать.</p>
	<code class="listing">
		<span class="key">var</span> toJsonObject2 = {<span class="string">"name"</span>: <span class="string">"Bill"</span>, <span class="string">"age"</span>: 42};<br />
		<span class="key">var</span> toJsonString2 = JSON.stringify(toJsonObject, [<span class="string">"name"</span>]);<br />
		<span class="comment">// toJsonString2 = '{"name":"Bill"}'</span>
	</code>
	<p>Третий необзательный параметр метода <b>stringify</b> позволяет отформатировать выходную строку, добавив указанное количество пробелов или указанную строку</p>
	<code class="listing">
		<span class="key">var</span> toJsonObject3 = {<span class="string">"name"</span>: <span class="string">"Bill"</span>, <span class="string">"age"</span>: 42};<br />
		<span class="key">var</span> toJsonString3 = JSON.stringify(toJsonObject, "", 4);<br />
		<span class="comment">/* toJsonString3 = <br />
		{<br />
    	&nbsp; &nbsp; "name": "Bill",<br />
    	&nbsp; &nbsp; "age": 42<br />
		}<br />
		*/</span>
	</code>
</body>
</html>